function HashMap(jsondata){if("string"==typeof jsondata){this.values=eval("("+jsondata+")")}else{if("object"==typeof jsondata){this.values=jsondata}else{if("undefined"!=typeof jsondata){throw new Error("对于HashMap的初始化数据jsondata只允许为json字符串和{}格式的数据对象")}else{this.values={}}}}}HashMap.prototype.clear=function(){this.values={}};HashMap.prototype.containsKey=function(key){return typeof(this.values[key])!="undefined"};HashMap.prototype.containsValue=function(value){for(var key in this.values){var val=this.values[key];if(val==value){return true}}return false};HashMap.prototype.get=function(key){if(this.containsKey(key)){return this.values[key]}else{return null}};HashMap.prototype.isEmpty=function(){return !this.size()};HashMap.prototype.keySet=function(){var result=[];for(var key in this.values){result.push(key)}return result};HashMap.prototype.put=function(key,value){this.values[key]=value;return value};HashMap.prototype.combine=function(map){var values=map.values;for(var key in values){var value=values[key];this.values[key]=value}};HashMap.prototype.remove=function(key){var value=this.containsKey(key)?this.get(key):undefined;if(value||(typeof(value)=="number"&&value==0)){delete this.values[key]}return value};HashMap.prototype.size=function(){var count=0;for(var key in this.values){count=count+1}return count};function List(jsondata){if("string"==typeof jsondata){this.values=eval("("+jsondata+")")}else{if("object"==typeof jsondata){this.values=jsondata}else{if("undefined"!=typeof jsondata){throw new Error("对于List的初始化数据jsondata只允许为json字符串和{}格式的数据对象")}else{this.values=[]}}}}List.prototype.clear=function(){this.values=[]};List.prototype.size=function(){return this.values.length};List.prototype.add=function(data){return this.values.push(data)};List.prototype.get=function(i){return this.values[i]};List.prototype.combine=function(list){var values=list.values;for(var i=0,n=values.length;i<n;i++){this.add(values[i])}};function URL(urlstr,method){if(arguments.length==1){this.urlStr=urlstr}else{if(arguments.length==2){this.urlStr=urlstr+"?method="+method}else{alert("传入的参数个数不正确");throw new Error("传入的参数个数不正确")}}this.paras=new HashMap()}URL.prototype.getURLString=function(){return this.urlStr};URL.prototype.getRealURLString=function(){var parasStr="";var keys=this.paras.keySet();for(var i=0,n=keys.length;i<n;i++){parasStr=parasStr+"&"+keys[i]+"="+this.paras.get(keys[i])}return this.urlStr+parasStr};URL.prototype.getPdfURLString=function(){var pdfviewer="./frame/plugins/pdfjs/web/viewer.html";var urlStr=GlobalVars.BASE_PATH+this.getRealURLString();var pdfviewHref=pdfviewer+"?rd="+randomString(6)+"&file="+encodeURIComponent(urlStr);return pdfviewHref};URL.prototype.getParas=function(){return this.paras.values};URL.prototype.addPara=function(key,value){if("undefined"==typeof value){return false}else{return this.paras.put(key,value)}};URL.prototype.addMap=function(map){this.paras.combine(map)};URL.prototype.addListData=function(key,data,colNames){if(chkObjNull(key)){alert("传入的关键字为空");return false}if(chkObjNull(colNames)){this.addPara("__grid_"+key,JSON.stringify({griddata:data}));return true}var colArr=colNames.split(",");var dataNew=[];for(var i=0,n=data.length;i<n;i++){var rowJson={};for(var j=0,m=colArr.length;j<m;j++){var colName=colArr[j];var rowDataJson=data[i];rowJson[colName]=rowDataJson[colName]}dataNew.push(rowJson)}this.addPara("__grid_"+key,JSON.stringify({griddata:dataNew}));return true};var AjaxUtil={syncRequest:function(url){var responseText=false;$.ajax({type:"post",async:false,url:url.getURLString(),data:url.getParas(),dataType:"text",success:function(data){responseText=data},complete:function(xhr,status){if("success"!=status){alert("请求出错：["+status+"]"+xhr.status+":"+xhr.statusText)}}});return responseText},asyncRequest:function(url,callback){$.ajax({type:"post",async:true,url:url.getURLString(),data:url.getParas(),dataType:"text",success:function(responseText){if("undefined"!=typeof callback&&null!=callback&&""!=callback){callback(responseText)}},complete:function(xhr,status){if("success"!=status){alert("请求出错：["+status+"]"+xhr.status+":"+xhr.statusText)}}})},syncBizRequest:function(url,callback){url.addPara("__jbjgid",getJbjgid("00000000"));url.addPara("__jbjgqxfw",getJbjgqxfw("00000000"));url.addPara("__yhid",getPageYhid());var data=AjaxUtil.syncRequest(url);if(AjaxUtil.checkException(data)){AjaxUtil.showException(data);return false}if("undefined"!=typeof callback&&null!=callback&&""!=callback){callback(data)}if(chkObjNull(data)){return true}return data},checkIsGoOn:function(data){if(typeof(data)=="boolean"){if(data){return true}else{return false}}else{return true}},asyncBizRequest:function(url,callback){url.addPara("__jbjgid",getJbjgid("00000000"));url.addPara("__jbjgqxfw",getJbjgqxfw("00000000"));url.addPara("__yhid",getPageYhid());AjaxUtil.asyncRequest(url,function(data){if(AjaxUtil.checkException(data)){AjaxUtil.showException(data);return false}if("undefined"!=typeof callback&&null!=callback&&""!=callback){callback(data)
}})},checkException:function(responseText){if("string"==typeof responseText){if(responseText.indexOf("<!--\r\n//errmsgsign_20150603_grace.easyFrame\r\n-->")>=0){return true}else{return false}}else{return false}},showException:function(reponseText){if($("#sys_errmsg_con_div").length<=0){$("body").append('<div id="sys_errmsg_con_div"></div>')}$("#sys_errmsg_con_div").html(reponseText)}};function closeBrowser(){if($.browser.msie){window.opener=null;window.open("","_self");window.close()}else{window.location.href="about:blank"}}function setJbjgid(jbjgid){if($("#__jbjgid").length<=0){throw new Error("页面中不存在jbjgid参数")}$("#__jbjgid").val(jbjgid)}function setJbjgqxfw(jbjgqxfw){if($("#__jbjgqxfw").length<=0){throw new Error("页面中不存在__jbjgqxfw参数")}$("#__jbjgqxfw").val(jbjgqxfw)}function getJbjgid(defalut){if($("#__jbjgid").length<=0){if(chkObjNull(defalut)){throw new Error("页面中不存在jbjgid参数")}return defalut}return $("#__jbjgid").val()}function getJbjgqxfw(defalut){if($("#__jbjgqxfw").length<=0){if(chkObjNull(defalut)){throw new Error("页面中不存在__jbjgqxfw参数")}return defalut}return $("#__jbjgqxfw").val()}function getPageYhid(){if($("#__yhid").length<=0){return""}return $("#__yhid").val()}function showLoading(){if($("#sys_loading_mask_div").length<=0){var divstr='<div id="sys_loading_mask_div" class="sys-loading-mask"><input id=\'sys_loading_mask_div_focus_input\' style="position: absolute;left:-200px;top:-200px;" type="text"/></div>';$("body").append(divstr)}else{$("#sys_loading_mask_div").show()}$("#sys_loading_mask_div_focus_input").focus()}function hideLoading(){if($("#sys_loading_mask_div").length>0){$("#sys_loading_mask_div").hide()}}function randomString(len){len=len||32;var chars="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";var maxPos=chars.length;var str="";for(var i=0;i<len;i++){str+=chars.charAt(Math.floor(Math.random()*maxPos))}return str}function chkObjNull(obj){if(typeof(obj)=="undefined"){return true}else{if(typeof(obj)=="string"){if(null==obj||""==obj){return true}else{return false}}else{if(null==obj){return true}else{return false}}}}function downloadSysFile(wjbs){if(chkObjNull(wjbs)){alert("文件唯一标识为空");return}var url=new URL("taglib.do","downloadSysFile");url.addPara("wjbs",wjbs);downloadFile2Form(url)}function downloadFile2Form(url){if("string"!=typeof url){url.addPara("__jbjgid",getJbjgid("00000000"));url.addPara("__jbjgqxfw",getJbjgqxfw("00000000"));url.addPara("__yhid",getPageYhid());url=url.getRealURLString()}var submitDataForm=document.createElement("FORM");submitDataForm.method="POST";submitDataForm=document.body.appendChild(submitDataForm);var urlArray=url.split("&");for(var i=1;i<urlArray.length;i++){var urlEle=urlArray[i];var o=document.createElement("INPUT");o.type="hidden";var key=urlEle.split("=")[0];o.name=key;o.id=key;o.value=decodeURIComponent(urlEle.substr(key.length+1));submitDataForm.appendChild(o)}submitDataForm.action=urlArray[0];submitDataForm.target="_self";submitDataForm.onsubmit=function(){return false};submitDataForm.submit();submitDataForm.outerHTML=""}function isIE11(){if(!!window.ActiveXObject||"ActiveXObject" in window){return true}else{return false}}var CookieUtil={set:function(name,value,days){var options={expires:365};if("undefined"!=typeof days&&null!=days&&""!=days){options={expires:days}}if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000))}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+options.path:"";var domain=options.domain?"; domain="+options.domain:"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")},get:function(name){var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+"=")){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};var DateUtil={getDateString:function(date,format){var yearString=date.getFullYear().toString();var monthString=(date.getMonth()+1).toString();var dayString=date.getDate().toString();var hourString=date.getHours().toString();var minuteString=date.getMinutes().toString();var secondString=date.getSeconds().toString();var result=format;if(yearString.length<4){yearString=this.getZero(4-yearString.length)+yearString}result=this.replaceString(result,"yyyy",yearString);if(monthString.length<2){monthString=this.getZero(2-monthString.length)+monthString}result=this.replaceString(result,"MM",monthString);if(dayString.length<2){dayString=this.getZero(2-dayString.length)+dayString}result=this.replaceString(result,"dd",dayString);if(hourString.length<2){hourString=this.getZero(2-hourString.length)+hourString}result=this.replaceString(result,"hh",hourString);
if(minuteString.length<2){minuteString=this.getZero(2-minuteString.length)+minuteString}result=this.replaceString(result,"mm",minuteString);if(secondString.length<2){secondString=this.getZero(2-secondString.length)+secondString}result=this.replaceString(result,"ss",secondString);return result},checkDate:function(str,formatString){var yearIndex=formatString.search("yyyy");var monthIndex=formatString.search("MM");var dayIndex=formatString.search("dd");var hourIndex=formatString.search("hh");var minuteIndex=formatString.search("mm");var secondIndex=formatString.search("ss");if(str==""){return true}if(str==null||str.length<=0){alert("字符串跟期望的输入值长度不匹配,期望输入值应该符合："+formatString);return false}if(str.length!=formatString.length){alert("字符串跟期望的输入值长度不匹配,期望输入值应该符合："+formatString);return false}for(var i=0;i<formatString.length;i++){var temp=formatString.substr(i,1);if(temp=="y"||temp=="M"||temp=="d"||temp=="h"||temp=="m"||temp=="s"){if((str.substr(i,1)<"0"||str.substr(i,1)>"9")){alert("字符串中存在非法字符,期望输入值应该符合："+formatString);return false}}if(temp=="-"||temp==":"||temp==" "){if(str.substr(i,1)!=temp){alert("字符串中存在非法字符,期望输入值应该符合："+formatString);return false}}}var allZero=true;for(var i=0;i<str.length;i++){var temp=str.substr(i,1);if(temp!="0"&&temp!="-"&&temp!=":"&&temp!=" "){allZero=false}}if(allZero){return false}if(yearIndex>=0){var year=new Number(str.substr(yearIndex,4));if(isNaN(year)||year==0||year<DateTimeMaskConfig.defaultLeastYear||year>DateTimeMaskConfig.defaultMaxYear){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString);return false}}if(monthIndex>=0){var month=new Number(str.substr(monthIndex,2));if(isNaN(month)||month<=0||month>12){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString);return false}}if(dayIndex>=0){var day=new Number(str.substr(dayIndex,2));if(isNaN(day)||day<=0||day>31){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString);return false}}if(day>28&&day<31){if(month==2){if(day!=29){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString+"。详细为："+year+"年"+month+"月无"+day+"日");return false}else{if((year%4)!=0){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString+"。详细为："+year+"年"+month+"月无"+day+"日");return false}else{if((year%100==0)&&(year%400!=0)){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString+"。详细为："+year+"年"+month+"月无"+day+"日");return false}}}}}else{if(day==31){if((month==2)||(month==4)||(month==6)||(month==9)||(month==11)){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString+"。详细为："+month+"月无"+day+"日");return false}}}if(hourIndex>=0){var hour=new Number(str.substr(hourIndex,2));if(isNaN(hour)||hour<0||hour>23){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString);return false}}if(minuteIndex>=0){var minute=new Number(str.substr(minuteIndex,2));if(isNaN(minute)||minute<0||minute>59){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString);return false}}if(secondIndex>=0){var second=new Number(str.substr(secondIndex,2));if(isNaN(second)||second<0||second>59){alert("字符串跟期望的输入值不匹配,期望输入值应该符合："+formatString);return false}}return true},getMonthDifferenceBetweenTwoDate:function(startTime,smask,endTime,emask){var sobj=new DateObj(startTime,smask);var eobj=new DateObj(endTime,emask);return sobj.compareMonthDiff(eobj)},compareDate:function(startTime,smask,endTime,emask){var sobj=new DateObj(startTime,smask);var eobj=new DateObj(endTime,emask);return sobj.compareTo(eobj)},changeFormat:function(dataTime,oldMask,newMask){var dateObj=new DateObj(dataTime,oldMask);return DateUtil.getDateString(dateObj.getDate(),newMask)},getObjValue:function(obj){var value=new DateObj(obj.value,obj.mask);return value.getDate()},getZero:function(zeroLength){if(zeroLength==null||zeroLength==0){return""}var temp="";for(var i=0;i<zeroLength;i++){temp+="0"}return temp},replaceString:function(objString,sourceString,reString){if(objString==null||objString.length==0||sourceString==null||sourceString.length==0||objString.search(sourceString)<0){return objString}var frontStr=objString.substr(0,objString.search(sourceString));var lastStr=objString.substr(objString.search(sourceString)+sourceString.length);return(frontStr||"")+(reString||"")+(lastStr||"")},getShowValue:function(obj,dateTimeString){if(dateTimeString==""){return""}if(!this.checkDate(dateTimeString,obj.mask)){return""}var result=obj.maskString;var yearString="";var monthString="";var dayString="";var hourString="";var minuteString="";var secondString="";if(obj.yearIndex>=0){var year=new Number(dateTimeString.substr(obj.yearIndex,4));if(isNaN(year)||year<DateTimeMaskConfig.defaultLeastYear){yearString=DateTimeMaskConfig.defaultLeastYear.toString()}else{if(year>DateTimeMaskConfig.defaultMaxYear){yearString=DateTimeMaskConfig.defaultMaxYear.toString()}else{yearString=year.toString()}}if(yearString.length<4){yearString=this.getZero(4-yearString.length)+yearString}result=this.replaceString(result,"yyyy",yearString)}if(obj.monthIndex>=0){var month=new Number(dateTimeString.substr(obj.monthIndex,2));if(isNaN(month)||month>12||month<=0){if(yearString!="0000"){monthString="01"}else{monthString="00"}}else{monthString=month.toString()}if(monthString.length<2){monthString=this.getZero(2-monthString.length)+monthString
}result=this.replaceString(result,"MM",monthString)}if(obj.dayIndex>=0){var day=new Number(dateTimeString.substr(obj.dayIndex,2));if(isNaN(day)||day>31||day<=0){if(yearString!="0000"&&monthString!="00"){dayString="01"}else{dayString="00"}}else{dayString=day.toString()}if(dayString.length<2){dayString=this.getZero(2-dayString.length)+dayString}result=this.replaceString(result,"dd",dayString)}if(obj.hourIndex>=0){var hour=new Number(dateTimeString.substr(obj.hourIndex,2));if(isNaN(hour)||hour>23||hour<=0){hourString="00"}else{hourString=hour.toString()}if(hourString.length<2){hourString=this.getZero(2-hourString.length)+hourString}result=this.replaceString(result,"hh",hourString)}if(obj.minuteIndex>=0){var minute=new Number(dateTimeString.substr(obj.minuteIndex,2));if(isNaN(minute)||minute>59||minute<=0){minuteString="00"}else{minuteString=minute.toString()}if(minuteString.length<2){minuteString=this.getZero(2-minuteString.length)+minuteString}result=this.replaceString(result,"mm",minuteString)}if(obj.secondIndex>=0){var second=new Number(dateTimeString.substr(obj.secondIndex,2));if(isNaN(second)||second>59||second<=0){secondString="00"}else{secondString=second.toString()}if(secondString.length<2){secondString=this.getZero(2-secondString.length)+secondString}result=this.replaceString(result,"ss",secondString)}return result},getShowValueByMask:function(mask,value){if(value==""){return""}if(!this.checkDate(value,mask)){return""}var result=mask;var yearString="";var monthString="";var dayString="";var hourString="";var minuteString="";var secondString="";var yearIndex=mask.search("yyyy");var monthIndex=mask.search("MM");var dayIndex=mask.search("dd");var hourIndex=mask.search("hh");var minuteIndex=mask.search("mm");var secondIndex=mask.search("ss");if(yearIndex>=0){var year=new Number(value.substr(yearIndex,4));if(isNaN(year)||year<DateTimeMaskConfig.defaultLeastYear){yearString=DateTimeMaskConfig.defaultLeastYear.toString()}else{if(year>DateTimeMaskConfig.defaultMaxYear){yearString=DateTimeMaskConfig.defaultMaxYear.toString()}else{yearString=year.toString()}}if(yearString.length<4){yearString=this.getZero(4-yearString.length)+yearString}result=this.replaceString(result,"yyyy",yearString)}if(monthIndex>=0){var month=new Number(value.substr(monthIndex,2));if(isNaN(month)||month>12||month<=0){if(yearString!="0000"){monthString="01"}else{monthString="00"}}else{monthString=month.toString()}if(monthString.length<2){monthString=this.getZero(2-monthString.length)+monthString}result=this.replaceString(result,"MM",monthString)}if(dayIndex>=0){var day=new Number(value.substr(dayIndex,2));if(isNaN(day)||day>31||day<=0){if(yearString!="0000"&&monthString!="00"){dayString="01"}else{dayString="00"}}else{dayString=day.toString()}if(dayString.length<2){dayString=this.getZero(2-dayString.length)+dayString}result=this.replaceString(result,"dd",dayString)}if(hourIndex>=0){var hour=new Number(value.substr(hourIndex,2));if(isNaN(hour)||hour>23||hour<=0){hourString="00"}else{hourString=hour.toString()}if(hourString.length<2){hourString=this.getZero(2-hourString.length)+hourString}result=this.replaceString(result,"hh",hourString)}if(minuteIndex>=0){var minute=new Number(value.substr(minuteIndex,2));if(isNaN(minute)||minute>59||minute<=0){minuteString="00"}else{minuteString=minute.toString()}if(minuteString.length<2){minuteString=this.getZero(2-minuteString.length)+minuteString}result=this.replaceString(result,"mm",minuteString)}if(secondIndex>=0){var second=new Number(value.substr(secondIndex,2));if(isNaN(second)||second>59||second<=0){secondString="00"}else{secondString=second.toString()}if(secondString.length<2){secondString=this.getZero(2-secondString.length)+secondString}result=this.replaceString(result,"ss",secondString)}return result}};String.prototype.trim=function(){return this.replace(/(^[\s]*)|([\s]*$)/g,"")};String.prototype.lTrim=function(){return this.replace(/(^[\s]*)/g,"")};String.prototype.rTrim=function(){return this.replace(/([\s]*$)/g,"")};String.prototype.endWith=function(str){if(this==null||str==null){return false}if(this.length<str.length){return false}else{if(this==str){return true}else{if(this.substring(this.length-str.length)==str){return true}}}return false};String.prototype.startWith=function(str){if(this==null||str==null){return false}if(this.length<str.length){return false}else{if(this==str){return true}else{if(this.substr(0,str.length)==str){return true}}}return false};String.prototype.contains=function(str){if(this==null){return false}if(str==null){return true}if(this.length<str.length){return false}else{if(this==str){return true}else{if(this.indexOf(str)!=-1){return true}}}return false};var NumberUtil={round:function(value,how){var num=new Number(value);var num1=new Number(num.toFixed(10));return parseFloat(num1.toFixed(how))},getValueWithSuffix:function(value){if(value==""){alert("输入参数【"+value+"】中不存在%,请检查");return}value=value.substr(0,value.length-1);if(value.indexOf(".")>2){value=value.substring(0,value.indexOf(".")-2)+"."+value.substring(value.indexOf(".")-2,value.indexOf("."))+value.substr(value.indexOf(".")+1)
}else{if(value.indexOf(".")==2){value="0."+value.substring(0,2)+value.substr(3)}else{if(value.indexOf(".")==1){value="0.0"+value.substring(0,1)+value.substr(2)}else{if(value.indexOf(".")==0){value="0.00"+value.substr(1)}else{if(value.indexOf(".")==-1){if(value.length>2){value=value.substr(0,value.length-2)+"."+value.substr(value.length-2)}else{if(value.length==2){value="0."+value.substr(0)}else{value="0.0"+value.substr(0)}}}}}}}return value},getValue:function(value,formatString){if(value==""){return"0"}var integerMaskString="";var SEPERATE_CHAR="";if(formatString.indexOf(".")<0){integerMaskString=formatString}else{integerMaskString=formatString.substr(0,formatString.indexOf("."))}var imsLen=integerMaskString.length;for(var i=0;i<imsLen;i++){var temp=integerMaskString.substr(i,1);if(temp=="#"){continue}else{if(temp=="0"){continue}else{SEPERATE_CHAR=temp||""}}}if(value.indexOf(SEPERATE_CHAR)<0){return value}else{var reg=new RegExp(SEPERATE_CHAR,"gi");return value.replace(reg,"")}},getRealValue:function(value,format){if(!format){format="###################0.00"}if(value.substr(value.length-1)=="%"){return parseFloat(NumberUtil.getValue(NumberUtil.getValueWithSuffix(value),format))}else{return parseFloat(NumberUtil.getValue(value,format))}},getShowValueByMask:function(mask,value){if(value==null||value==""){value=""}if(value.indexOf("%")>0){var vnumber=value.substr(0,value.length-1);if(!isNaN(vnumber)){value=parseFloat(vnumber)/100;value=NumberUtil.getShowValueByMask(mask,value.toString())}return value}if(value.indexOf(",")>0){return value}var nLen=value.length;for(var i=0;i<nLen;i++){var temp=value.substr(i,1);if((temp<"0"||temp>"9")&&temp!="."&&temp!="-"){return""}}if(mask.indexOf("%")>0){if(value!=""){value=Math.round((parseFloat(value)*100)*10000)/10000;value=value.toString()}}var sign="";if(value.substr(0,1)=="-"){sign="-";value=value.substr(1)}if(isNaN(value)){return""}var integerNumbers="";var floatNumbers="";if(value.indexOf(".")<0){integerNumbers=value}else{var number=value.split(".");if(number.length==1){integerNumbers=number[0]}else{if(number.length==2){integerNumbers=number[0];floatNumbers=number[1]}else{return value}}}while(integerNumbers.length>1&&integerNumbers.substr(0,1)=="0"){integerNumbers=integerNumbers.substr(1)}var MAX_FORMAT_LENGTH=0;var FORMAT_LENGTH=0;var FLOAT_LENGTH=0;var SEPERATE_CHAR="";var suffix="";if(mask.substring(0,1)=="+"){mask=mask.substring(1,mask.length)}if(mask.substring(mask.length-1,mask.length)=="%"){suffix="%";mask=mask.substring(0,mask.length-1)}var integerMaskString="";var floatMaskString="";if(mask.indexOf(".")<0){integerMaskString=mask}else{integerMaskString=mask.substr(0,mask.indexOf("."));floatMaskString=mask.substr(mask.indexOf(".")+1)}if(integerMaskString==null){integerMaskString=""}if(floatMaskString==null){floatMaskString=""}var countOfZero=0;var countOfExtra=0;var imsLen=integerMaskString.length;for(var i=0;i<imsLen;i++){var temp=integerMaskString.substr(i,1);if(temp=="#"){countOfExtra++;continue}else{if(temp=="0"){countOfZero++;continue}else{SEPERATE_CHAR=temp||""}}}FORMAT_LENGTH=countOfZero;MAX_FORMAT_LENGTH=countOfZero+countOfExtra;if(SEPERATE_CHAR==null){SEPERATE_CHAR=""}countOfZero=0;countOfExtra=0;var fmsLen=floatMaskString.length;for(var i=0;i<fmsLen;i++){var temp=floatMaskString.substr(i,1);if(temp=="#"){countOfExtra++;continue}else{if(temp=="0"){countOfZero++;continue}}}FLOAT_LENGTH=countOfExtra+countOfZero;var count=0;if(integerNumbers.length>MAX_FORMAT_LENGTH){integerNumbers=integerNumbers.substr(integerNumbers.length-MAX_FORMAT_LENGTH)}if(integerNumbers.length<FORMAT_LENGTH){count=FORMAT_LENGTH-integerNumbers.length;for(var i=0;i<count;i++){integerNumbers+="0"}}if(floatNumbers.length>FLOAT_LENGTH){floatNumbers=floatNumbers.substr(0,FLOAT_LENGTH)}else{count=FLOAT_LENGTH-floatNumbers.length;for(var i=0;i<count;i++){floatNumbers+="0"}}var seperateCount=Math.round(integerNumbers.length/3);var result="";for(var i=0;i<seperateCount;i++){result=SEPERATE_CHAR+integerNumbers.substring(integerNumbers.length-3,integerNumbers.length)+result;integerNumbers=integerNumbers.substring(0,integerNumbers.length-3)}if((integerNumbers==null||integerNumbers.length==0)&&SEPERATE_CHAR!=""){result=result.substring(1,result.length)}else{result=integerNumbers+result}if(FLOAT_LENGTH>0){return sign+result+"."+floatNumbers+suffix}else{return sign+result+suffix}},checkNumber:function(str,mask){var number;if(str==""){return true}if(str.indexOf("%")>-1&&mask.indexOf("%")>-1){if(str.indexOf(".")>-1&&mask.indexOf(".")>-1){return NumberUtil.checkNumberValid(str,mask)}else{if(str.indexOf(".")==-1&&mask.indexOf(".")==-1){return NumberUtil.checkNumberValid(str,mask)}else{alert("输入的值跟格式不匹配,期望输入值应该符合："+mask);return false}}}else{if(str.indexOf("%")==-1&&mask.indexOf("%")==-1){if(str.indexOf(".")>-1&&mask.indexOf(".")>-1){return NumberUtil.checkNumberValid(str,mask)}else{if(str.indexOf(".")==-1&&mask.indexOf(".")==-1){return NumberUtil.checkNumberValid(str,mask)}else{alert("输入的值跟格式不匹配,期望输入值应该符合："+mask);
return false}}}else{alert("输入的值跟格式不匹配,期望输入值应该符合："+mask);return false}}},checkNumberValid:function(numbers,mask){if(numbers==null){return false}if(numbers==""){return true}var nLen=numbers.length;for(var i=0;i<nLen;i++){var temp=numbers.substr(i,1);if((temp<"0"||temp>"9")&&temp!="."&&temp!="-"&&temp!="%"&&temp!=","){alert("数字串中存在非法字符,期望输入值应该符合："+mask);return false}}var integerNumbers="";var floatNumbers="";if(numbers.indexOf(".")<0){integerNumbers=numbers}else{var number=numbers.split(".");if(number.length==1){integerNumbers=number[0]}else{if(number.length==2){integerNumbers=number[0];floatNumbers=number[1]}else{alert("数字传中存在多个小数点,期望输入值应该符合："+mask);return false}}}if(integerNumbers.length>3&&integerNumbers.indexOf(",")==-1&&mask.indexOf(",")>-1){alert("整数部分中缺少分割符,期望输入值应该符合："+mask);return false}while(integerNumbers.indexOf(",")>-1){if(integerNumbers.length-integerNumbers.lastIndexOf(",")-1==3){integerNumbers=integerNumbers.substr(0,integerNumbers.lastIndexOf(","))}else{alert("数字串中的分隔符的位置不对,期望输入值应该符合："+mask);return false}}if(integerNumbers.length>1&&integerNumbers.substr(0,1)=="0"){alert("整数的第一个字符为0,期望输入值应该符合："+mask);return false}if(mask.substring(0,1)=="+"){mask=mask.substring(1,mask.length)}if(mask.substring(mask.length-1,mask.length)=="%"){mask=mask.substring(0,mask.length-1)}var integerMaskString="";var floatMaskString="";if(mask.indexOf(".")<0){integerMaskString=mask}else{integerMaskString=mask.substr(0,mask.indexOf("."));floatMaskString=mask.substr(mask.indexOf(".")+1)}if(integerNumbers.length>integerMaskString.length){alert("整数长度超过允许的最大长度,期望输入值应该符合："+mask);return false}var tnumbers="";for(var i=0;i<nLen;i++){var temp=numbers.substr(i,1);if(temp!=","){tnumbers=tnumbers+temp}}numbers=tnumbers;var sign="";if(numbers.substr(0,1)=="-"){sign="-";numbers=numbers.substr(1)}if(numbers.substr(numbers.length-1,1)=="%"){numbers=numbers.substring(0,numbers.length-1)}if(isNaN(numbers)){alert("数字传不是一个合法的数字,期望输入值应该符合："+mask);return false}return true}};function accMul(arg1,arg2){var m=0,s1=arg1.toString(),s2=arg2.toString();try{m+=s1.split(".")[1].length}catch(e){}try{m+=s2.split(".")[1].length}catch(e){}return Number(s1.replace(".",""))*Number(s2.replace(".",""))/Math.pow(10,m)}Number.prototype.mul=function(arg){return accMul(arg,this)};function accAdd(arg1,arg2){var r1,r2,m;try{r1=arg1.toString().split(".")[1].length}catch(e){r1=0}try{r2=arg2.toString().split(".")[1].length}catch(e){r2=0}m=Math.pow(10,Math.max(r1,r2));return(arg1*m+arg2*m)/m}Number.prototype.add=function(arg){return accAdd(arg,this)};function accDiv(arg1,arg2){var t1=0,t2=0,r1,r2;try{t1=arg1.toString().split(".")[1].length}catch(e){}try{t2=arg2.toString().split(".")[1].length}catch(e){}with(Math){r1=Number(arg1.toString().replace(".",""));r2=Number(arg2.toString().replace(".",""));return(r1/r2)*pow(10,t2-t1)}}Number.prototype.div=function(arg){return accDiv(this,arg)};function accSub(arg1,arg2){var r1,r2,m,n;try{r1=arg1.toString().split(".")[1].length}catch(e){r1=0}try{r2=arg2.toString().split(".")[1].length}catch(e){r2=0}m=Math.pow(10,Math.max(r1,r2));n=(r1>=r2)?r1:r2;return((arg1*m-arg2*m)/m).toFixed(n)}Number.prototype.sub=function(arg){return accSub(this,arg)};